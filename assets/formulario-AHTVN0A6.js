import{c as w,u as S,r as l,j as e}from"./index-CRExCRem.js";import{D as $,f as k}from"./DynamicForm-CLLUo3tw.js";import{C as c,B as u}from"./card-Bb8NJHUM.js";import"./textarea-CcIngyZx.js";const C=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],I=w("arrow-left",C);function T(){const m=S(),[r,x]=l.useState(null),[g,h]=l.useState(!0),[f,y]=l.useState({});l.useEffect(()=>{const s=localStorage.getItem("selectedTemplate");s&&x(JSON.parse(s)),h(!1)},[]);const b=s=>{y(s)},j=(s,t,o,d)=>{const i=`<span class="route-empty-field" style="padding: 4px 8px; border-radius: 4px; font-weight: 500; margin: 0 2px; display: inline-block;">${o}</span>`;if(t==null||t==="")return i;switch(s){case"image":return`<img src="${String(t)}" alt="${o}" style="max-width: 100%; max-height: 300px; border-radius: 4px; border: 1px solid var(--primary);" />`;case"imageList":return t.filter(a=>a.url).map(a=>`<div style="margin-bottom: 12px; text-align: center; margin-top: 8px">
              <img src="${a.url}" alt="${a.description}" style="max-width: 100%; max-height: 200px; border-radius: 4px; border: 1px solid var(--primary); ; margin-left: auto; margin-right: auto;" />
              ${a.description?`<p style="margin-top: 4px; font-size: 0.875rem; color: var(--muted-foreground);">${a.description}</p>`:""}
            </div>`).join("")||i;case"list":{const p=t.filter(a=>a).map(a=>`<li style="margin-left: 20px; margin-bottom: 4px; list-style: initial;">${a}</li>`).join("");return p?`<ul style="margin: 8px 0; padding-left: 20px;">${p}</ul>`:i}case"number":return`<span class="route-value-badge" style="padding: 4px 8px; border-radius: 4px; font-weight: 500; margin: 0 2px; display: inline-block;">${k(t,d)}</span>`;default:return`<span class="route-value-badge" style="padding: 4px 8px; border-radius: 4px; font-weight: 500; margin: 0 2px; display: inline-block;">${String(t)}</span>`}},v=()=>{if(!r)return"";let s=r.markdown;return r.fields.forEach(t=>{const o=f[t.id],d=t.id.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),i=new RegExp(`<field-node[^>]*id="${d}"[^>]*>.*?</field-node>`,"gi"),n=j(t.type,o,t.label,t.numberFormat);s=s.replace(i,n)}),s},N=s=>{try{const t=JSON.parse(localStorage.getItem("submissions")||"[]");t.unshift(s),localStorage.setItem("submissions",JSON.stringify(t)),alert("Formulário enviado com sucesso!"),m({to:"/enviados"})}catch(t){console.error("Erro ao salvar envio:",t),alert("Erro ao enviar formulário")}};return g?e.jsx("div",{className:"min-h-screen p-8 route-container flex items-center justify-center",children:e.jsx(c,{className:"p-8 text-center route-card",children:e.jsx("p",{className:"route-text-muted",children:"Carregando formulário..."})})}):r?e.jsx("div",{className:"min-h-screen p-8 route-container",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(u,{variant:"outline",onClick:()=>m({to:"/templates"}),children:[e.jsx(I,{})," Voltar para Templates"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-2/5",children:e.jsx(c,{className:"p-5 route-card",children:e.jsx($,{title:r.title,description:r.description,content:r.markdown,fields:r.fields,templateId:r.id,onSubmit:N,onDataChange:b})})}),e.jsx("div",{className:"w-full",children:e.jsxs(c,{className:"p-6 sticky top-8 route-card h-full",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Pre Visualização"}),e.jsx("div",{className:"prose prose-sm max-w-none p-4 rounded route-preview-bg overflow-y-auto max-h-full",dangerouslySetInnerHTML:{__html:v()}})]})})]})]})}):e.jsx("div",{className:"min-h-screen p-8 route-container",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsxs(c,{className:"p-8 text-center route-card",children:[e.jsx("p",{className:"route-text-muted mb-4",children:"Nenhum template selecionado"}),e.jsx(u,{onClick:()=>m({to:"/templates"}),children:"Voltar para Templates"})]})})})}export{T as component};
