import{r as f,j as s}from"./index-B5WOI7hk.js";import{B as x}from"./card-76uj9AK6.js";import{T as v,I as b}from"./textarea-Bj7t9tXD.js";function q(m,n="simple"){const p=String(m).replace(/\D/g,"");switch(n){case"currency":return U(p);case"document":return B(p);default:return p}}function U(m){if(!m)return"";const n=parseInt(m,10),p=n%100;return`R$ ${Math.floor(n/100).toLocaleString("pt-BR")+","+p.toString().padStart(2,"0")}`}function B(m){if(!m)return"";const n=m.replace(/\D/g,"");return n.length<=11?n.replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"):n.length<=14?n.replace(/(\d{2})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1/$2").replace(/(\d{4})(\d)/,"$1-$2"):n}function E(m){return m.replace(/\D/g,"")}function J({title:m,description:n,fields:p,onSubmit:j,onDataChange:d,onDownloadHTML:N,templateId:w}){const[o,u]=f.useState({}),$=(e,t)=>{const r={...o,[e]:t};u(r),d?.(r)},D=(e,t)=>{const r=E(t),a={...o,[e]:r||""};u(a),d?.(a)},F=(e,t)=>{const r=t.target.files?.[0];if(!r)return;const a=new FileReader;a.onload=l=>{const c=l.target?.result,i={...o,[e]:c};u(i),d?.(i)},a.readAsDataURL(r)},C=e=>{u(t=>{const r=t[e]??[],a={...t,[e]:[...r,{url:"",description:""}]};return d?.(a),a})},R=(e,t,r,a)=>{u(l=>{const i=[...l[e]??[]];i[t]={...i[t],[r]:a};const h={...l,[e]:i};return d?.(h),h})},L=(e,t,r)=>{const a=r.target.files?.[0];if(!a)return;const l=new FileReader;l.onload=c=>{const i=c.target?.result;u(h=>{const g=[...h[e]??[]];g[t]={...g[t],url:i};const y={...h,[e]:g};return d?.(y),y})},l.readAsDataURL(a)},S=e=>{u(t=>{const r=t[e]??[],a={...t,[e]:[...r,""]};return d?.(a),a})},k=(e,t,r)=>{u(a=>{const c=[...a[e]??[]];c[t]=r;const i={...a,[e]:c};return d?.(i),i})},A=(e,t)=>{u(r=>{const l=[...r[e]??[]];l.splice(t,1);const c={...r,[e]:l};return d?.(c),c})},I=e=>{e.preventDefault();const t={templateId:w,submissionId:`sub_${Date.now()}`,data:o,submittedAt:new Date};j?.(t)};return s.jsxs("form",{onSubmit:I,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:m}),n&&s.jsx("p",{className:"text-gray-600",children:n})]}),s.jsx("div",{className:"space-y-6",children:p.map(e=>s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"block font-medium",children:[e.label,e.required&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.type==="text"&&s.jsx(v,{value:o[e.id]||"",onChange:t=>$(e.id,t.target.value)}),e.type==="number"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(b,{type:"text",value:o[e.id]?q(String(o[e.id]),e?.numberFormat||"simple"):"",onChange:t=>D(e.id,t.target.value),placeholder:e.placeholder,required:e.required}),e?.numberFormat&&s.jsxs("div",{className:"text-xs text-gray-500",children:[e?.numberFormat==="currency"&&"Formato: Moeda (R$)",e?.numberFormat==="document"&&"Formato: CPF/CNPJ",e?.numberFormat==="simple"&&"Formato: NÃºmero simples"]})]}),e.type==="image"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(b,{type:"file",accept:"image/*",onChange:t=>F(e.id,t),required:e.required&&!o[e.id]}),o[e.id]?s.jsxs("div",{className:"relative w-full max-w-sm",children:[s.jsx("img",{src:o[e.id],alt:"Preview",className:"w-full h-auto rounded border"}),s.jsx("button",{type:"button",onClick:()=>u(t=>{const r={...t};return delete r[e.id],r}),className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded text-sm",children:"Remover"})]}):null]}),e.type==="imageList"&&s.jsxs("div",{className:"space-y-3",children:[(o[e.id]||[]).map((t,r)=>s.jsxs("div",{className:"p-3 border rounded space-y-2",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"text-sm font-medium",children:["Imagem ",r+1]}),s.jsx(b,{type:"file",accept:"image/*",onChange:a=>L(e.id,r,a)}),t.url&&s.jsx("img",{src:t.url,alt:`Item ${r+1}`,className:"w-full h-32 object-cover rounded mt-2"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium",children:"DescriÃ§Ã£o"}),s.jsx(v,{value:t.description,onChange:a=>R(e.id,r,"description",a.target.value),placeholder:"DescriÃ§Ã£o da imagem",rows:2})]}),s.jsx("button",{type:"button",onClick:()=>u(a=>{const c=[...a[e.id]??[]];return c.splice(r,1),{...a,[e.id]:c}}),className:"text-red-500 text-sm hover:underline",children:"Remover item"})]},r)),s.jsx(x,{type:"button",onClick:()=>C(e.id),variant:"outline",className:"w-full",children:"+ Adicionar Imagem"})]}),e.type==="list"&&s.jsxs("div",{className:"space-y-2",children:[(o[e.id]||[]).map((t,r)=>s.jsxs("div",{className:"flex gap-2",children:[s.jsx(b,{value:t,onChange:a=>k(e.id,r,a.target.value),placeholder:"Item da lista"}),s.jsx("button",{type:"button",onClick:()=>A(e.id,r),className:"px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600",children:"âœ•"})]},r)),s.jsx(x,{type:"button",onClick:()=>S(e.id),variant:"outline",className:"w-full",children:"+ Adicionar Item"})]})]},e.id))}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx(x,{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700",children:"Enviar FormulÃ¡rio"}),N&&s.jsx(x,{type:"button",onClick:N,variant:"outline",className:"flex-1",children:"ðŸ’¾ Salvar como HTML"})]})]})}export{J as D,q as f};
