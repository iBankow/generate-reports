import{u as I,r,j as e}from"./index-B5WOI7hk.js";import{B as o,C as u}from"./card-76uj9AK6.js";function k(){const x=I(),[s,p]=r.useState([]),[j,v]=r.useState(!0),[l,f]=r.useState(null);r.useEffect(()=>{const t=JSON.parse(localStorage.getItem("submissions")||"[]");p(t),v(!1)},[]);const b=()=>{const t=JSON.stringify(s,null,2),n=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download=`submissions_${new Date().toISOString().split("T")[0]}.json`,i.click(),URL.revokeObjectURL(a)},N=()=>{if(s.length===0)return;const t=s[0],n=Object.keys(t.data),a=[["ID","Data de Envio",...n].join(","),...s.map(d=>[d.submissionId,new Date(d.submittedAt).toLocaleString("pt-BR"),...n.map(S=>{const m=d.data[S];return typeof m=="string"?`"${m}"`:JSON.stringify(m)})])].join(`
`),i=new Blob([a],{type:"text/csv"}),h=URL.createObjectURL(i),c=document.createElement("a");c.href=h,c.download=`submissions_${new Date().toISOString().split("T")[0]}.csv`,c.click(),URL.revokeObjectURL(h)},g=t=>{if(confirm("Tem certeza que deseja deletar este envio?")){const n=s.filter(a=>a.submissionId!==t);p(n),localStorage.setItem("submissions",JSON.stringify(n))}};return e.jsx("div",{className:"min-h-screen p-8 route-container",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Envios"}),e.jsx("p",{className:"route-text-muted",children:"Visualize todos os formulÃ¡rios enviados"})]}),e.jsx(o,{variant:"outline",onClick:()=>x({to:"/templates"}),children:"â† Voltar para Templates"})]}),j?e.jsx(u,{className:"p-12 text-center route-card route-text-muted",children:"Carregando envios..."}):s.length===0?e.jsxs(u,{className:"p-12 text-center route-card",children:[e.jsx("p",{className:"route-text-muted mb-4",children:"Nenhum formulÃ¡rio enviado ainda"}),e.jsx(o,{variant:"outline",onClick:()=>x({to:"/templates"}),children:"Ir para Templates"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2 mb-6",children:[e.jsx(o,{variant:"outline",size:"sm",onClick:b,children:"ğŸ“¥ Exportar JSON"}),e.jsx(o,{variant:"outline",size:"sm",onClick:N,children:"ğŸ“¥ Exportar CSV"}),e.jsx("div",{className:"flex-1"}),e.jsxs("span",{className:"text-sm route-text-muted self-center",children:["Total: ",s.length," envio",s.length!==1?"s":""]})]}),e.jsx("div",{className:"space-y-4",children:s.map(t=>e.jsxs(u,{className:"p-6 hover:shadow-lg transition route-card",children:[e.jsx("div",{className:"flex justify-between items-start mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-bold text-lg mb-1",children:["Envio #",t.submissionId.slice(0,8)]}),e.jsx("p",{className:"text-sm route-text-muted",children:new Date(t.submittedAt).toLocaleString("pt-BR")})]})}),e.jsxs("button",{onClick:()=>f(l===t.submissionId?null:t.submissionId),className:"route-text-primary font-medium",children:[l===t.submissionId?"â–¼":"â–¶"," Detalhes"]}),l===t.submissionId&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"route-submission-details p-4 rounded mb-4 max-h-96 overflow-auto",children:e.jsx("pre",{className:"text-xs whitespace-pre-wrap font-mono",children:JSON.stringify(t.data,null,2)})}),e.jsx("div",{className:"flex gap-2",children:e.jsx(o,{variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",onClick:()=>g(t.submissionId),children:"ğŸ—‘ï¸ Deletar"})})]})]},t.submissionId))})]})]})})}export{k as component};
